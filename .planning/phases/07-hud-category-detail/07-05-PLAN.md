---
phase: 07-hud-category-detail
plan: 05
type: execute
wave: 2
depends_on: [07-04]
files_modified:
  - src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "hud-category-detail.page.ts calls getHudByService() instead of getVisualsByService()"
    - "MOBILE mode loads HUD records from 'hud' cache type via getCachedServiceData"
  artifacts:
    - path: "src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts"
      provides: "Correct HUD data loading calls"
      contains: "getHudByService"
  key_links:
    - from: "hud-category-detail.page.ts"
      to: "hud-data.service.ts getHudByService()"
      via: "hudData.getHudByService()"
      pattern: "getHudByService\\(this\\.serviceId\\)"
---

<objective>
Wire hud-category-detail.page.ts to use getHudByService() for HUD record loading

Purpose: Plan 07-04 created getHudByService() method. This plan wires the page to call it instead of getVisualsByService().

Output: HUD category-detail loads from correct LPS_Services_HUD table
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/07-hud-category-detail/07-VERIFICATION.md
@.planning/phases/07-hud-category-detail/07-04-SUMMARY.md
@src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace getVisualsByService with getHudByService calls</name>
  <files>src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts</files>
  <action>
Find and replace all calls to getVisualsByService() with getHudByService():

1. WEBAPP MODE (loadDataFromAPI method, around line 717):
   - Before: this.hudData.getVisualsByService(this.serviceId)
   - After: this.hudData.getHudByService(this.serviceId)

2. MOBILE MODE (initializeVisualFields method, around line 637):
   - Before: const visuals = await this.indexedDb.getCachedServiceData(this.serviceId, 'visuals') || [];
   - After: const visuals = await this.indexedDb.getCachedServiceData(this.serviceId, 'hud') || [];

3. Update any console.log messages that reference "visuals" to say "HUD records" for clarity.

4. Search for any other getVisualsByService references in the file and update them to getHudByService.
   Use grep to find: grep -n "getVisualsByService\|'visuals'" in the file

The variable name can remain 'visuals' for compatibility with existing code that processes the data,
but the data source must be changed to HUD table.
  </action>
  <verify>
grep -n "getVisualsByService" src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts
# Should return 0 matches

grep -n "getHudByService" src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts
# Should return at least 1 match (WEBAPP mode)

grep -n "'visuals'" src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts
# Should return 0 matches in data loading context (may exist in comments or other contexts)
  </verify>
  <done>
- getVisualsByService() replaced with getHudByService() in WEBAPP mode
- getCachedServiceData cache type changed from 'visuals' to 'hud' in MOBILE mode
- No EFE visuals table references remain in data loading path
  </done>
</task>

</tasks>

<verification>
1. grep for 'getVisualsByService' - should return 0 matches
2. grep for 'getHudByService' - should return 1+ matches
3. grep for "getCachedServiceData.*'visuals'" - should return 0 matches in data loading context
4. TypeScript compiles without errors
</verification>

<success_criteria>
- All data loading paths use getHudByService() or 'hud' cache type
- No references to getVisualsByService() or 'visuals' cache type remain in data loading
</success_criteria>

<output>
After completion, create `.planning/phases/07-hud-category-detail/07-05-SUMMARY.md`
</output>
