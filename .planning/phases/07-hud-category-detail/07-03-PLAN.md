---
phase: 07-hud-category-detail
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "MOBILE mode loads HUD templates from 'hud' cache, not 'visual' cache"
    - "MOBILE mode loads HUD dropdown options from 'hud_dropdown' cache, not 'visual_dropdown' cache"
  artifacts:
    - path: "src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts"
      provides: "Correct cache type references for MOBILE mode"
      contains: "getCachedTemplates('hud')"
  key_links:
    - from: "hud-category-detail (mobile path)"
      to: "IndexedDB hud cache"
      via: "getCachedTemplates('hud')"
      pattern: "getCachedTemplates\\('hud'\\)"
---

<objective>
Fix MOBILE mode cache type references in hud-category-detail.page.ts

Purpose: MOBILE mode currently loads EFE templates and dropdown options instead of HUD templates because it uses 'visual' and 'visual_dropdown' cache types. This gap was introduced when the page was copied from EFE.

Output: MOBILE mode loads from correct HUD cache types ('hud', 'hud_dropdown')
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/07-hud-category-detail/07-VERIFICATION.md
@src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix MOBILE cache type references</name>
  <files>src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts</files>
  <action>
In the initializeVisualFields() method (MOBILE path around lines 600-700):

1. Line 609: Change getCachedTemplates('visual_dropdown') to getCachedTemplates('hud_dropdown')
   - Before: const cachedDropdownData = await this.indexedDb.getCachedTemplates('visual_dropdown') || [];
   - After: const cachedDropdownData = await this.indexedDb.getCachedTemplates('hud_dropdown') || [];

2. Line 616: Change getCachedTemplates('visual') to getCachedTemplates('hud')
   - Before: const templates = await this.indexedDb.getCachedTemplates('visual') || [];
   - After: const templates = await this.indexedDb.getCachedTemplates('hud') || [];

These changes ensure MOBILE mode loads HUD templates (TypeID=2) from the correct cache populated by ensureHudTemplatesReady(), not EFE templates (TypeID=1) from the 'visual' cache.

Update console.log messages to reflect 'HUD' instead of 'visual' for clarity.
  </action>
  <verify>
grep -n "getCachedTemplates('visual')" src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts
# Should return NO matches (all should be 'hud' or 'hud_dropdown')

grep -n "getCachedTemplates('hud')" src/app/pages/hud/hud-category-detail/hud-category-detail.page.ts
# Should return at least 2 matches (templates and dropdown)
  </verify>
  <done>
- getCachedTemplates('visual_dropdown') changed to getCachedTemplates('hud_dropdown') on line 609
- getCachedTemplates('visual') changed to getCachedTemplates('hud') on line 616
- No 'visual' or 'visual_dropdown' cache references remain in MOBILE path
  </done>
</task>

</tasks>

<verification>
1. grep for 'getCachedTemplates.*visual' in hud-category-detail.page.ts - should return 0 matches
2. grep for 'getCachedTemplates.*hud' in hud-category-detail.page.ts - should return 2+ matches
3. File compiles without TypeScript errors (ng build --project=app will catch)
</verification>

<success_criteria>
MOBILE mode cache type references use 'hud' and 'hud_dropdown' instead of 'visual' and 'visual_dropdown'
</success_criteria>

<output>
After completion, create `.planning/phases/07-hud-category-detail/07-03-SUMMARY.md`
</output>
