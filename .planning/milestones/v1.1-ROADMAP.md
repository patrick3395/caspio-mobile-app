# Milestone v1.1: HUD Page Structure Refactor

**Status:** SHIPPED 2026-01-25
**Phases:** 5-7
**Total Plans:** 10

## Overview

Refactored HUD template from tab-based navigation to button-based page navigation matching engineers-foundation patterns. Fixed all table references to use HUD tables (LPS_Services_HUD, LPS_Services_HUD_Templates, LPS_Services_HUD_Attach) instead of EFE/Visuals tables.

## Phases

### Phase 5: Navigation Refactor

**Goal**: Main page displays navigation buttons instead of tabs, enabling direct page navigation
**Depends on**: Phase 4 (v1.0 complete)
**Plans**: 2 plans

Plans:
- [x] 05-01-PLAN.md — Update HUD main page cards array (2 items) and fix navigateTo path
- [x] 05-02-PLAN.md — Update HUD container goBack() for URL-based hierarchical navigation

**Details:**
- Main page shows exactly 2 navigation buttons (Project Details, HUD / Mobile Manufactured)
- navigateTo() routes to correct /hud sub-paths
- goBack() uses URL-based hierarchy instead of browser history

### Phase 6: Project Details Page

**Goal**: Project Details page matches engineers-foundation layout, styling, and functionality exactly
**Depends on**: Phase 5
**Plans**: 2 plans

Plans:
- [x] 06-01-PLAN.md — Verify HUD Project Details matches EFE (file parity + visual/functional verification)
- [x] 06-02-PLAN.md — Fix HUD container router-outlet (gap closure - critical routing fix)

**Details:**
- Research discovered HUD Project Details already byte-for-byte identical to EFE
- Gap closure: HUD container needed router-outlet pattern for child route rendering
- CSS visibility toggle used instead of *ngIf for loading states

### Phase 7: HUD Category Detail

**Goal**: HUD detail page loads from correct tables, displays templates, and pushes selections with Dexie-first pattern
**Depends on**: Phase 6
**Plans**: 6 plans

Plans:
- [x] 07-01-PLAN.md — Fix template loading to use ensureHudTemplatesReady (HUD templates)
- [x] 07-02-PLAN.md — Add HUDID fallback to all VisualID references (~36 locations)
- [x] 07-03-PLAN.md — Fix MOBILE cache type references (visual -> hud)
- [x] 07-04-PLAN.md — Create getHudByService() method for HUD data loading
- [x] 07-05-PLAN.md — Wire page to use getHudByService() instead of getVisualsByService()
- [x] 07-06-PLAN.md — Fix photo upload routing to use entityType 'hud'

**Details:**
- Templates load from LPS_Services_HUD_Templates (TypeID=2)
- Data loads from LPS_Services_HUD via getHudByService()
- Photos route to LPS_Services_HUD_Attach via entityType 'hud'
- All cache types use 'hud' instead of 'visual'
- Dexie-first pattern verified working

---

## Milestone Summary

**Key Decisions:**

- Use ensureHudTemplatesReady() for HUD pages, not getVisualsTemplates()
- HUDTemplateID takes priority in template matching fallback chain
- Use HUDID as first fallback in all visual ID extraction patterns
- MOBILE mode uses 'hud' and 'hud_dropdown' cache types
- Use entityType 'hud' for photo uploads
- CSS visibility toggle instead of *ngIf for router-outlet wrapper

**Issues Resolved:**

- HUD navigation used tab-based pattern (should be button-based)
- HUD container lacked router-outlet for child routes
- Template loading used EFE method (ensureVisualsTemplates)
- Data loading used EFE tables (LPS_Services_Visuals)
- Photo uploads routed to EFE attachment table
- Cache types used 'visual' instead of 'hud'

**Issues Deferred:**

- visualFieldRepo TypeID=1 filtering may affect HUD (TypeID=2) in mobile mode — needs device testing
- Device testing for offline/sync behavior

**Technical Debt Incurred:**

- None significant

---

_For current project status, see .planning/ROADMAP.md (will be created for next milestone)_
