<ion-header>
  <ion-toolbar>
    <ion-title>Help Guide</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Loading help guide...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-container">
    <ion-icon name="alert-circle-outline" class="error-icon"></ion-icon>
    <p>{{ error }}</p>
    <ion-button (click)="loadFiles()" fill="outline" size="small">
      Retry
    </ion-button>
  </div>

  <!-- File Sections -->
  <div *ngIf="!loading && !error" class="sections-container">
    <div *ngFor="let section of fileSections" class="file-section">
      <h2 class="section-title">{{ section.typeName }}</h2>
      
      <ion-card *ngFor="let file of section.files" class="file-card">
        <ion-card-content>
          <div class="file-content">
            <!-- File Preview -->
            <div class="file-preview">
              <div *ngIf="isImageFile(file.FileFile)" class="image-preview">
                <img [src]="getFileUrl(file.FileFile)" 
                     [alt]="file.Description"
                     (click)="openFile(file.FileFile)"
                     loading="lazy">
              </div>
              
              <div *ngIf="isPdfFile(file.FileFile)" class="pdf-preview" (click)="openFile(file.FileFile)">
                <ion-icon name="document-text-outline" class="file-icon"></ion-icon>
                <span class="file-type">PDF</span>
              </div>
              
              <div *ngIf="!isImageFile(file.FileFile) && !isPdfFile(file.FileFile)" 
                   class="generic-preview" 
                   (click)="openFile(file.FileFile)">
                <ion-icon name="document-outline" class="file-icon"></ion-icon>
                <span class="file-type">{{ getFileExtension(file.FileFile) }}</span>
              </div>
            </div>
            
            <!-- File Description -->
            <div class="file-info">
              <h3 class="file-description">{{ file.Description }}</h3>
              <div class="file-actions">
                <ion-button (click)="openFile(file.FileFile)" 
                           fill="outline" 
                           size="small"
                           color="primary">
                  <ion-icon slot="start" name="open-outline"></ion-icon>
                  Open File
                </ion-button>
              </div>
            </div>
          </div>
        </ion-card-content>
      </ion-card>
    </div>

    <!-- Empty State -->
    <div *ngIf="fileSections.length === 0" class="empty-state">
      <ion-icon name="folder-open-outline" class="empty-icon"></ion-icon>
      <h3>No Help Files Available</h3>
      <p>Help guide files will appear here once they are uploaded.</p>
    </div>
  </div>
</ion-content>