{
  "name": "Caspio Mobile App - Group 2: Critical Mobile Fixes",
  "branchName": "feature/critical-mobile-fixes-group2",
  "skipAgents": ["tester"],
  "completionCriteria": "Mark complete when code edits are done - do not wait for testing",
  "userStories": [
    {
      "id": "US-001",
      "title": "First Photo Album Upload on New Visual - Stuck Queue Issue (MOBILE ONLY)",
      "description": "CRITICAL: In structural systems section (structural-category pages), the FIRST photo uploaded via photo album to a NEW visual gets stuck in sync queue and fails. Second and subsequent photos sync successfully. Camera photos work fine as first photo. The issue is SPECIFICALLY the first photo album upload on a newly created visual.",
      "mobileOnlyIssue": true,
      "completed": false,
      "narrowedDownCause": {
        "trigger": "First photo album upload on a NEW visual",
        "worksCorrectly": [
          "Camera photos as first photo on new visual",
          "Second and subsequent photo album uploads",
          "Photo album uploads on existing visuals with photos"
        ],
        "fails": [
          "First photo album upload on a brand new visual"
        ]
      },
      "symptoms": [
        "First photo from album on new visual stuck in sync queue",
        "Backend gets row without an Attachment for first photo",
        "Broken/missing image in UI for first photo",
        "Second+ photos sync successfully"
      ],
      "acceptanceCriteria": [
        "First photo album upload on new visual syncs successfully",
        "No photos stuck in queue regardless of upload order",
        "Backend rows all have attachments",
        "No broken/missing image links in UI",
        "Works for: first camera photo, first album photo, multiple album photos"
      ],
      "investigationSteps": [
        "Compare code path for camera capture vs photo album on NEW visual",
        "Check if visual record is fully created before first album upload starts",
        "Look for race condition between visual creation and first photo album upload",
        "Check if camera capture has different timing/sequencing that avoids the bug",
        "Investigate IndexedDB state when first album photo is added to new visual",
        "Check if second photo succeeds because visual is now fully initialized"
      ],
      "priority": 1,
      "skipTester": true,
      "markCompleteOnCodeEdit": true
    }
  ],
  "completedStories": [
    {
      "id": "US-002",
      "title": "Random Hard Refreshes Throughout App - FIXED",
      "fixedIn": "commit 93e1ad55 in zeroshot/ruby-atlas-15 branch",
      "solution": "Changed auto-reload to user confirmation dialog to prevent unexpected hard refreshes"
    }
  ],
  "agentInstructions": {
    "skipTester": true,
    "completionTrigger": "code_edits_complete",
    "notes": "Skip the Tester agent. Mark tasks complete when code edits are done."
  },
  "metadata": {
    "updatedAt": "2026-01-14T11:00:00.000Z"
  }
}
