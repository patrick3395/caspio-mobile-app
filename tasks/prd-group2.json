{
  "name": "Caspio Mobile App - Group 2: Critical Mobile Fixes",
  "branchName": "feature/critical-mobile-fixes-group2",
  "skipAgents": ["tester"],
  "completionCriteria": "Mark complete when code edits are done - do not wait for testing",
  "userStories": [
    {
      "id": "US-001",
      "title": "Multi-Image Upload - Phantom Row & Stuck Queue Issue (MOBILE ONLY)",
      "description": "CRITICAL: In structural systems section (Foundations, Grading and Drainage, etc), when adding more than one photo from photo album, one photo remains stuck in the sync queue. When uploading 3 photos: 1 stays in sync queue, 3 rows are added to backend but one has NO attachment, and the UI shows 4 images instead of 3 (one is a broken image because there's no attachment).",
      "mobileOnlyIssue": true,
      "completed": false,
      "symptoms": [
        "1 image stuck in sync queue after multi-image upload",
        "Backend gets extra row without an Attachment",
        "UI shows N+1 images (e.g., upload 3, see 4)",
        "One image in UI is broken/missing (no attachment)"
      ],
      "acceptanceCriteria": [
        "All selected images sync successfully - none stuck in queue",
        "Backend rows match number of images uploaded (3 photos = 3 rows with attachments)",
        "UI displays correct number of images (3 photos = 3 images shown)",
        "No broken/missing image links in UI",
        "No phantom rows without attachments created",
        "Works correctly with 2, 3, 4, 5+ images"
      ],
      "investigationSteps": [
        "Trace the multi-image selection flow in structural-category pages",
        "Check if duplicate LocalImage records are being created",
        "Look for race conditions between queue processing and UI updates",
        "Verify attachment upload completes before row creation",
        "Check if phantom row is created before blob is ready",
        "Investigate why UI count differs from actual uploaded count",
        "Check outbox/queue processing for duplicate entries"
      ],
      "priority": 1,
      "skipTester": true,
      "markCompleteOnCodeEdit": true
    }
  ],
  "completedStories": [
    {
      "id": "US-002",
      "title": "Random Hard Refreshes Throughout App - FIXED",
      "fixedIn": "commit 93e1ad55 in zeroshot/ruby-atlas-15 branch",
      "solution": "Changed auto-reload to user confirmation dialog to prevent unexpected hard refreshes"
    }
  ],
  "agentInstructions": {
    "skipTester": true,
    "completionTrigger": "code_edits_complete",
    "notes": "Skip the Tester agent. Mark tasks complete when code edits are done."
  },
  "metadata": {
    "updatedAt": "2026-01-14T07:45:00.000Z"
  }
}
